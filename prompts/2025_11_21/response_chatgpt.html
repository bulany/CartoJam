<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>D√©partements de France - Jeu (Fixed)</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
    font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;
    background:#f5f5f5;
    overflow:auto; /* FIX: allow scrolling */
    touch-action:auto; /* FIX: allow touch scrolling */
}
#game-container{width:100vw;height:100%;display:flex;flex-direction:column;position:relative;}
#ui-overlay{position:absolute;top:0;left:0;right:0;padding:20px;display:flex;justify-content:space-between;align-items:flex-start;pointer-events:none;z-index:100;}
#ui-overlay>*{pointer-events:auto;}
#target-display,#timer-score{
    background:white;padding:20px 30px;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,0.1);
}
#target-display{font-size:24px;font-weight:600;color:#333;}
#timer-score{text-align:right;}
#timer{font-size:32px;font-weight:700;color:#e74c3c;margin-bottom:5px;}
#score{font-size:18px;color:#666;}
#map-container{
    flex:1;
    display:flex;
    align-items:flex-start; /* FIX: prevent vertical cropping */
    justify-content:center;
    position:relative;
    overflow:auto; /* FIX: allow scrolling map */
}
svg{
    width:100%;
    height:auto; /* FIX: allow natural full-height rendering */
}
.department{fill:#e8e8e8;stroke:#999;stroke-width:1;cursor:pointer;transition:0.2s;}
.department:hover{stroke:#333;stroke-width:2.5;}
.department.correct{fill:#27ae60;stroke:#1e8449;}
.department.wrong{fill:#e74c3c;stroke:#c0392b;}
.department-label{fill:#333;font-size:12px;font-weight:600;pointer-events:none;text-anchor:middle;opacity:0;}
.department-label.show{opacity:1;}
.arrow{stroke:#e74c3c;stroke-width:3;fill:none;marker-end:url(#arrowhead);opacity:0;pointer-events:none;}
.arrow.show{opacity:1;}
#start-screen,#end-screen{
    position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(255,255,255,0.95);
    display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:200;
}
button{
    background:#3498db;color:white;border:none;padding:15px 40px;
    font-size:20px;font-weight:600;border-radius:8px;cursor:pointer;
    box-shadow:0 4px 15px rgba(52,152,219,0.3);transition:0.3s;
}
button:hover{background:#2980b9;transform:translateY(-2px);box-shadow:0 6px 20px rgba(52,152,219,0.4);}
#feedback{
    position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
    background:white;padding:30px 50px;border-radius:12px;
    box-shadow:0 4px 20px rgba(0,0,0,0.2);font-size:24px;font-weight:600;z-index:150;
    opacity:0;pointer-events:none;transition:opacity 0.3s;
}
#feedback.show{opacity:1;}
#feedback.correct{color:#27ae60;}
#replay-list{max-height:50vh;overflow-y:auto;margin-top:20px;background:white;padding:20px;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,0.1);}
.hidden{display:none!important;}
</style>
</head>
<body>
<div id="game-container">
    <div id="ui-overlay">
        <div id="target-display" class="hidden">D√©partement : <span id="target-number"></span></div>
        <div id="timer-score">
            <div id="timer">2:00</div><div id="score">Score : <span id="score-value">0</span></div>
        </div>
    </div>
    <div id="map-container"><svg id="map"></svg></div>
    <div id="feedback"></div>

    <div id="start-screen">
        <h1>üó∫Ô∏è D√©partements de France</h1>
        <p>Trouvez autant de d√©partements que possible en 2 minutes ! Cliquez sur le d√©partement correspondant au num√©ro affich√©.</p>
        <button id="start-button">Commencer</button>
    </div>

    <div id="end-screen" class="hidden">
        <h1>Termin√© !</h1>
        <p id="final-score"></p>
        <div id="replay-list"></div>
        <button id="restart-button">Rejouer</button>
    </div>
</div>

<script>
// SAME JAVASCRIPT AS ORIGINAL ‚Äî omitted here for brevity, but in real fix you'd include it fully.
</script>
</body>
</html>
