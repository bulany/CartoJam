Great â€” we can absolutely build this together.
Since weâ€™re still early in the setup phase, letâ€™s begin by **laying the foundations for a Svelte PWA**, and then weâ€™ll build the **interactive â€œreference modeâ€** (hovering, highlighting, prefecture dot, region outline, arrow-key navigation).

Below is the cleanest, modern setup path for what you described.

---

# âœ… **PHASE 1: Set Up a Svelte PWA Project**

Weâ€™ll use **SvelteKit**, because:

* It supports PWAs very cleanly via the official `@vite-pwa/sveltekit` plugin.
* It handles routing, file-based assets, static exporting, etc.
* Itâ€™s ideal for single-page-app-style projects.
* You can still deploy it as a *single-page* PWA.

## 1. **Create the project**

From a terminal:

```bash
npm create svelte@latest departements-ref
cd departements-ref
npm install
```

When prompted:

* âœ” Skeleton project
* âœ” TypeScript â€” **optional**, but recommended
* âœ” Add ESLint â€” optional
* âœ” Add Prettier â€” optional

## 2. Install the PWA plugin

```bash
npm install -D @vite-pwa/sveltekit
```

Then edit `vite.config.js` and add:

```js
import { sveltekit } from '@sveltejs/kit/vite';
import { SvelteKitPWA } from '@vite-pwa/sveltekit';

export default {
  plugins: [
    sveltekit(),
    SvelteKitPWA({
      registerType: 'autoUpdate',
      manifest: {
        name: 'DÃ©partements de France',
        short_name: 'DÃ©partements',
        start_url: '/',
        display: 'standalone',
        background_color: '#ffffff',
        theme_color: '#ffffff',
        icons: [
          {
            src: 'icon-192.png',
            sizes: '192x192',
            type: 'image/png'
          },
          {
            src: 'icon-512.png',
            sizes: '512x512',
            type: 'image/png'
          }
        ]
      }
    })
  ]
};
```

(Iâ€™ll generate icons later once we have visuals.)

## 3. Test PWA mode

```bash
npm run dev
```

Then open the app in a browser â€” you should see the service worker and PWA manifest being applied.

---

# âœ… **PHASE 2: Preparing the Map Data**

To support your reference mode, we need:

* Department polygons
* Department metadata (name, number, prefecture city, region)
* Prefecture coordinates
* Region polygons

To keep things simple and open-source, weâ€™ll use the excellent official geographic dataset:

### ğŸ“ **GEOJSON SOURCE**

**IGN (France) Admin Express** â€” open license
Contains all departments, prefectures, regions, etc.

I can preprocess this for you into 2 handy files:

### **1. departments.geojson**

Containing:

* geometry (polygon)
* department number (`code`)
* department name (`nom`)
* prefecture coordinates (`pref_x`, `pref_y`)
* region code

### **2. regions.geojson**

Containing region polygons.

### **3. departments.json**

A clean metadata table:

```json
{
  "01": {
    "name": "Ain",
    "prefecture": "Bourg-en-Bresse",
    "region": "Auvergne-RhÃ´ne-Alpes"
  },
  "02": {
    "name": "Aisne",
    "prefecture": "Laon",
    "region": "Hauts-de-France"
  }
}
```

ğŸ‘‰ **Question:**
Would you like me to generate these files now and embed them as static assets in your Svelte project, or should we load them from a CDN?

---

# âœ… **PHASE 3: Building the Reference Mode UI (Svelte)**

This is the mode you described:

* Map of France

* Hover â†’

  * highlight department
  * show department number (large)
  * show name
  * show prefecture
  * show region
  * show prefecture dot
  * highlight region outline

* Click â†’ department â€œsticksâ€

* Arrow keys â†’ numerical navigation (01 â†’ 02 â†’ 03 etc)

The structure of the UI looks like this:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Interactive Map (SVG)      â”‚ Department Info Panel    â”‚
â”‚   - Hover highlights dept    â”‚ - Big number             â”‚
â”‚   - Prefecture dot           â”‚ - Name                   â”‚
â”‚   - Region outline           â”‚ - Prefecture             â”‚
â”‚                              â”‚ - Region                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Weâ€™ll build:

1. `+page.svelte` â†’ contains the layout and map
2. `Map.svelte` â†’ renders the SVG and handles interactions
3. `stores.js` â†’ Svelte store for current department

All styling can be minimalist and modern (thin clean outlines, subtle hover glow, crisp typography).

---

# ğŸš€ **NEXT STEP: I need one piece of information from you**

Before I generate the project scaffolding and full Svelte components:

### **Which dataset source do you prefer?**

1ï¸âƒ£ **I generate the final preprocessed GeoJSON & JSON files right here**, and you drop them into:
`static/data/departments.geojson`,
`static/data/regions.geojson`,
`src/lib/data/departments.json`.

2ï¸âƒ£ **You download the original IGN dataset** and I provide a small Node script that transforms it into the clean formats the app needs.

3ï¸âƒ£ **You want everything embedded into the Svelte code (no external files)** â€” possible, but the file will be large (~800KB).

---

# ğŸŸ¦ **What would you like? Option 1, 2, or 3?**

Once you choose, Iâ€™ll immediately:

* prepare the project structure
* create the Svelte components
* build the hover/highlight/prefecture-dot system
* implement sticky-select + arrow navigation
* ensure full responsiveness
* integrate PWA manifest + service worker

This will give you the exact â€œreference modeâ€ experience you described.

Which option do you choose?
